# -*- coding: utf-8 -*-
'''
Created on 18 July 2011
@author: tcezard
'''
import sys, os, logging
from IO_interface import vcfIO

if __name__=='__main__':
    """Get the snps present in SS1 and SS3 but not in SS4"""
    input_file=sys.argv[1]
    open_input = open(input_file)
    reader = vcfIO.VcfReader(open_input)
    for record in reader:
        valid_genotype_SS1 = record.get_valid_genotype_per_sample(genotype_quality_threshold=20, sample_list=['SS1'])
        valid_genotype_SS3 = record.get_valid_genotype_per_sample(genotype_quality_threshold=20, sample_list=['SS3'])
        valid_genotype_SS4 = record.get_valid_genotype_per_sample(genotype_quality_threshold=20, sample_list=['SS4'])
        genotype_cancer_SS1 = set()
        genotype_cancer_SS3 = set()
        if len(valid_genotype_SS1.keys())>0:
            genotype_cancer_SS1.update(valid_genotype_SS1.keys()[0].split('/'))
        if len(valid_genotype_SS3.keys())>0:
            genotype_cancer_SS3.update(set(valid_genotype_SS3.keys()[0].split('/')))
        if len(valid_genotype_SS4.keys())>0 and valid_genotype_SS4.keys()[0] == '0/0' :
            if genotype_cancer_SS1.issuperset(set('1')) and genotype_cancer_SS3.issuperset(set('1')):
                sys.stdout.write('011\t')
                print record
            elif genotype_cancer_SS1.issuperset(set('1')) and not genotype_cancer_SS3.issuperset(set('1')):
                sys.stdout.write('010\t')
                print record
            elif not genotype_cancer_SS1.issuperset(set('1')) and genotype_cancer_SS3.issuperset(set('1')):
                sys.stdout.write('001\t')
                print record
       