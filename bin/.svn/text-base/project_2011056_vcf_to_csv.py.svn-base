# -*- coding: utf-8 -*-
'''
Created on 23 February 2012
@author: tcezard
'''
import sys, os
from IO_interface import vcfIO


if __name__=='__main__':
    """Get the snps present in High not in Low and the other way around"""
    input_vcf_file=sys.argv[1]
    open_input = open(os.path.abspath(input_vcf_file))
    reader = vcfIO.VcfReader(open_input)
    sample_names = reader.get_sample_names()
    header="Chromosome,position,reference,alternate,quality"
    for sample in sample_names:
        header+=",%s genotype"%sample
        header+=",%s quality"%sample
    print header
    for record in reader:
        out=[]
        out.append(str(record.get_reference()))
        out.append(str(record.get_position()))
        out.append(str(record.get_id()))
        out.append(str(record.get_reference_base()))
        out.append(str(record.get_alt_bases()[0]))
        out.append(str(record.get_qual()))
        for sample in sample_names:
            out.append(str(record.get_genotype(sample)))
            out.append(str(record.get_genotype_quality(sample)))
        for entry in record.vcf_line_split[9+len(sample_names):]:
            out.append(entry)
        print ','.join(out)
        
    open_input.close()
