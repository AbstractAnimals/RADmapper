'''
Created on 31 Mar 2010

@author: tcezard
'''
import sys
from utils.FastaFormat import FastaWriter

if __name__=="__main__":
    """print the size of a sequence """
    from utils.FastaFormat import FastaReader
    if len(sys.argv)>1 and sys.argv[1] is not None:
        input_file=sys.argv[1]
    else:
        print 'You must provide an input file'
        sys.exit()
        
    print input_file
    reader=FastaReader(open(input_file))
    total=0
    for (header,sequence) in reader:
        total+=len(sequence)
        print header, len(sequence)
    print input_file, total


if __name__=="1__main__":
    """Extract one or several sequence from fasta."""
    from utils.FastaFormat import FastaReader
    if len(sys.argv)>1 and sys.argv[1] is not None:
        input_file=sys.argv[1]
    else:
        print 'You must provide an input file'
        sys.exit()
    sequence_names=[]
    if len(sys.argv)>2:
        for arg in sys.argv[2:]:
            sequence_names.append(arg) 
    else:
        print 'You must provide at least an sequence name'
        sys.exit()
    writer=FastaWriter(sys.stdout, 60)
    reader=FastaReader(open(input_file))
    total=0
    for (header,sequence) in reader:
        if header in sequence_names:
            writer.start_sequence(header)
            writer.write_sequence(sequence)
    writer.close()
